<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MIPschell: Process Layout</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MIPschell
   &#160;<span id="projectnumber">1.3.0</span>
   </div>
   <div id="projectbrief">A language for writing Mixed Integer Programs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Process Layout </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="mipshell_procLayout"></a>
Process Layout</h1>
<p>The most common approach to developing a process layout is to arrange departments consisting of like processes in a way that optimizes their relative placement. In many situations, optimal placement often means placing departments with large amount of interdepartment traffic adjacent to one another.</p>
<p>Suppose that we want to arrange <em>n</em> departments among <em>m</em> sites to minimize the cost of moving departments to new places and the interdepartment material handling cost. Let <img class="formulaInl" alt="$p_{is}$" src="form_68.png"/> denote the cost of moving department <em>i</em> to site <em>s</em>. Usually, <img class="formulaInl" alt="$p_{is}=0$" src="form_69.png"/> if department <em>i</em> is currently situated at site <em>s</em>, and <img class="formulaInl" alt="$p_{is}$" src="form_68.png"/> is a rather big number (penalty) if department <em>i</em> cannot be moved to site <em>s</em>. Let us also assume that expected expenses (during some planning horizon) on transporting materials between departments <em>i</em> and <em>j</em>, if they where situated at sites <em>s</em> and <em>r</em>, are <img class="formulaInl" alt="$c_{ijsr}$" src="form_70.png"/>. These expenses depend on the material traffic between the departments as well as the distance between the sites.</p>
<h2><a class="anchor" id="mipshell_procLayoutDEMO"></a>
Illustrative Example</h2>
<p>Consider a low-volume toy factory with eight departments:</p><ul>
<li>1) shipping and receiving,</li>
<li>2) sewing,</li>
<li>3) metal forming,</li>
<li>4) plastic molding and stamping,</li>
<li>5) small toy assembly,</li>
<li>6) large toy assembly,</li>
<li>7) mechanism assembly,</li>
<li>8) painting.</li>
</ul>
<p>Suppose that we want to arrange these eight departments of a toy factory to minimize the total cost of moving departments to new locations and the interdepartment material handling cost during planning horizon of 5 years.</p>
<center> <a class="anchor" id=""></a>
<table class="doxtable">
<caption>Table 1: <em>Plan of factory building</em></caption>
<tr>
<td><b>1</b>  </td><td><b>3</b>  </td><td><b>5</b>  </td><td><b>7</b>  </td></tr>
<tr>
<td><b>2</b>  </td><td><b>4</b>  </td><td><b>6</b>  </td><td><b>8</b>  </td></tr>
</table>
</center><p>To make presentation clearer, let us make some simplifying assumptions. The factory building has 8 rooms of equal size, 10&amp;m wide and 10m long, that are arranged as in Figure&#160;2. Initially department&#160;<em>i</em> is allocated in room&#160;<em>i</em> (<em>i</em>=1,&amp;hellip,8). The cost of moving any department to a new location is $200. Therefore, moving costs are defined by the rule: <img class="formulaInl" alt="$p_{ii}=0$" src="form_71.png"/>, and <img class="formulaInl" alt="$p_{is}=200$" src="form_72.png"/> for <em>i</em>&amp;lte <em>s</em>.</p>
<center> <a class="anchor" id=""></a>
<table class="doxtable">
<caption>Table 2: <em>Material flows between departments</em></caption>
<tr>
<th></th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8  </th></tr>
<tr>
<th>1 </th><td>0 </td><td>60 </td><td>150 </td><td>40 </td><td>180 </td><td>30 </td><td>20  </td></tr>
<tr>
<th>2 </th><td></td><td>20 </td><td>100 </td><td>20 </td><td>7 </td><td>23 </td><td>0  </td></tr>
<tr>
<th>3 </th><td></td><td></td><td>0 </td><td>90 </td><td>125 </td><td>178 </td><td>98  </td></tr>
<tr>
<th>4 </th><td></td><td></td><td></td><td>75 </td><td>90 </td><td>95 </td><td>80  </td></tr>
<tr>
<th>5 </th><td></td><td></td><td></td><td></td><td>0 </td><td>182 </td><td>162  </td></tr>
<tr>
<th>6 </th><td></td><td></td><td></td><td></td><td></td><td>115 </td><td>325  </td></tr>
<tr>
<th>7 </th><td></td><td></td><td></td><td></td><td></td><td></td><td>8  </td></tr>
</table>
</center><p>All materials are transported in a standard-size crate by a forklift truck, one crate to a truck. Suppose that transportation costs are $1 to move one crate between adjacent departments and $1 extra for each department in between. The expected material flows between departments for one year of operation are given in Table&#160;2.</p>
<p>For example, if initially the departments are arranged as follows, </p><center> <table class="doxtable">
<tr>
<td><b>5</b>  </td><td><b>1</b>  </td><td><b>7</b>  </td><td><b>8</b>  </td></tr>
<tr>
<td><b>3</b>  </td><td><b>2</b>  </td><td><b>6</b>  </td><td><b>4</b>  </td></tr>
</table>
</center><p> the per year interdepartment material handling cost for the following arrangement of departments is calculated as follows:</p>
<center> <table class="doxtable">
<tr>
<td>0&sdot;1 </td><td>+&#160;60&sdot;1 </td><td>+&#160;150&sdot;2 </td><td>+&#160;40&sdot;2 </td><td>+&#160;180&sdot;3 </td><td>+&#160;30&sdot;3 </td><td>+&#160;20&sdot;4 </td><td></td></tr>
<tr>
<td></td><td>+&#160;20&sdot;2 </td><td>+&#160;100&sdot;1 </td><td>+&#160;20&sdot;3 </td><td>+&#160;7&sdot;2 </td><td>+&#160;23&sdot;4 </td><td>+&#160;0&sdot;3 </td><td></td></tr>
<tr>
<td></td><td></td><td>+&#160;0&sdot;1 </td><td>+&#160;90&sdot;1 </td><td>+&#160;125&sdot;1 </td><td>+&#160;178&sdot;2 </td><td>+&#160;98&sdot;3 </td><td></td></tr>
<tr>
<td></td><td></td><td></td><td>+&#160;75&sdot;2 </td><td>+&#160;90&sdot;1 </td><td>+&#160;95&sdot;3 </td><td>+&#160;80&sdot;2 </td><td></td></tr>
<tr>
<td></td><td></td><td></td><td></td><td>+&#160;0&sdot;1 </td><td>+&#160;182&sdot;1 </td><td>+&#160;162&sdot;2 </td><td></td></tr>
<tr>
<td></td><td></td><td></td><td></td><td></td><td>+&#160;115&sdot;2 </td><td>+&#160;325&sdot;1 </td><td></td></tr>
<tr>
<td></td><td></td><td></td><td></td><td></td><td></td><td>+&#160;8&sdot;1 </td><td>= 4075  </td></tr>
</table>
</center><p>Thus, the material handling cost during the planning horizon is 5&sdot;$4075=$20375.</p>
<h2><a class="anchor" id="mipshell_procLayou_IP"></a>
Integer Programming Formulation</h2>
<p>To write an integer program (IP) that models our process layout problem, we introduce two sets of binary variables:</p><ul>
<li><img class="formulaInl" alt="$x_{is}=1$" src="form_73.png"/> if department <em>i</em> is allocated at site <img class="formulaInl" alt="$s\in S_i$" src="form_74.png"/>, and <img class="formulaInl" alt="$x_{is}=0$" src="form_75.png"/> otherwise;</li>
<li><img class="formulaInl" alt="$y_{ijsr}=1$" src="form_76.png"/> only if <img class="formulaInl" alt="$x_{is}=x_{jr}=1$" src="form_77.png"/>, and <img class="formulaInl" alt="$y_{ijsr}=0$" src="form_78.png"/> otherwise.</li>
</ul>
<p>With these variables the problem is formulated as follows:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align} &amp;\sum_{i=1}^n\sum_{s=1}^m p_{is} x_{is} + \sum_{i=1}^{n-1}\sum_{j=i+1}^n\sum_{s=1}^m\sum_{r=1}^m c_{ijsr} y_{ijsr} \to \min,\tag{1.a}\\ &amp;\sum_{s=1}^m x_{is} = 1,\quad i=1,\dots,n,\tag{1.b}\\ &amp;\sum_{i=1}^n x_{is} \le 1,\quad s=1,\dots,n,\tag{1.c}\\ &amp;2 y_{ijsr} \le x_{is} + x_{jr},\quad s,r=1,\dots,m,\; j=i+1,\dots,n,\; i=1,\dots,n-1,\tag{1.d}\\ &amp;\sum_{s=1}^m\sum_{r=1}^m y_{ijsr} = 1,\quad j=i+1,\dots,n,\; i=1,\dots,n-1,\tag{1.e}\\ &amp;x_{ij} \in \{0,1\},\quad j=i+1,\dots,n,\; i=1,\dots,n-1,\tag{1.f}\\ &amp;y_{ijsr} \in \{0,1\},\quad s,r=1,\dots,m,\; j=i+1,\dots,n,\; i=1,\dots,n-1.\tag{1.g} \end{align}" src="form_79.png"/>
</p>
<p>The objective (1.a) is to minimize the total expenses on moving the departments and the expenses on transporting materials between the all departments. The equations (1.b) require that each department be moved to exactly one site, and the equations (1.c) do not allow two departments to share one site. The inequalities (1.d) and (1.e) impose the required relation between the <em>x</em> an <em>y</em> variables.</p>
<h2><a class="anchor" id="mipshell_procLayouImpl"></a>
MIPshell-implementation</h2>
<p>We implemented the process layout problem as a <b>C++</b> class, named <code>Cproclayout</code>, which definition is as follows.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mipshell_8h.html">mipshell.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>Cproclayout: <span class="keyword">public</span> <a class="code" href="classCProblem.html">CProblem</a></div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> <a class="codeRef" doxygen="/home/nick/programs/mip/mipcl/docs/mipcl.tag:../../../mipcl/docs/html/" href="../../../mipcl/docs/html/classCLP.html#a25af32c327f27ddc37b545b684b1648c">m_iN</a>, <a class="codeRef" doxygen="/home/nick/programs/mip/mipcl/docs/mipcl.tag:../../../mipcl/docs/html/" href="../../../mipcl/docs/html/classCLP.html#ab80f06b19b6118f2fe4d6738378e0d9d">m_iM</a>;</div><div class="line">    <span class="keywordtype">int</span> *m_ipMovingCost, *m_ipDist, *m_ipFlow;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Cproclayout(<span class="keyword">const</span> <span class="keywordtype">char</span>* name);</div><div class="line"><span class="preprocessor">#ifdef __THREADS_</span></div><div class="line">    Cproclayout(<span class="keyword">const</span> Cproclayout &amp;other, <span class="keywordtype">int</span> thread);</div><div class="line">    <a class="codeRef" doxygen="/home/nick/programs/mip/mipcl/docs/mipcl.tag:../../../mipcl/docs/html/" href="../../../mipcl/docs/html/classCMIP.html">CMIP</a>* <a class="codeRef" doxygen="/home/nick/programs/mip/mipcl/docs/mipcl.tag:../../../mipcl/docs/html/" href="../../../mipcl/docs/html/classCMIP.html#a33363f035bbd0ac5746cc4753886b013">clone</a>(<span class="keyword">const</span> <a class="codeRef" doxygen="/home/nick/programs/mip/mipcl/docs/mipcl.tag:../../../mipcl/docs/html/" href="../../../mipcl/docs/html/classCMIP.html">CMIP</a> *pMip, <span class="keywordtype">int</span> thread);</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">    <span class="keyword">virtual</span> ~Cproclayout();</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> model();</div><div class="line"></div><div class="line">    <span class="keywordtype">void</span> readData(<span class="keyword">const</span> <span class="keywordtype">char</span>* fileName);</div><div class="line">    <span class="keywordtype">void</span> printSol(<a class="code" href="classCVarVector.html">VAR_VECTOR</a> &amp;x);</div><div class="line">    </div><div class="line">    <span class="keywordtype">int</span> c(<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j, <span class="keywordtype">int</span> s, <span class="keywordtype">int</span> r);</div><div class="line">    <span class="keywordtype">int</span> p(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> s) {<span class="keywordflow">return</span> m_ipMovingCost[i*m_iM+s];}</div><div class="line">};</div><div class="line"></div></div><!-- fragment --><p><code>Cproclayout</code> has the following members for storing problem instances:</p><ul>
<li><code>m_iN</code>: number of departments;</li>
<li><code>m_iM</code>: number of sites;</li>
<li><code>m_ipMovingCost</code>: integer array of size <code>m\_iN * m_iM</code>, where</li>
<li><code>m_ipMovingCost[i,s]</code> is cost of moving department <code>i</code> to site <code>s</code>;</li>
<li><code>m_ipDist</code>: integer array of size <code>m_iM*(m_iM-1)/2</code> to store upper triangle of distance matrix;</li>
<li><code>m_ipFlow</code>: integer array of size <code>m_iN*(m_iN-1)/2</code> to store upper triangle of interdepartment material-flow matrix.</li>
</ul>
<p>The default constructor of <code>Cproclayout</code></p>
<p><div class="fragment"><div class="line">Cproclayout::Cproclayout(<span class="keyword">const</span> <span class="keywordtype">char</span>* name): <a class="code" href="classCProblem.html">CProblem</a>(name)</div><div class="line">{</div><div class="line">    m_ipMovingCost=0;</div><div class="line">    <span class="keywordtype">char</span> fileName[128];</div><div class="line">    strcpy(fileName,name);</div><div class="line">    strcat(fileName,<span class="stringliteral">&quot;.txt&quot;</span>);</div><div class="line">    readData(fileName);</div><div class="line">}</div></div><!-- fragment --></p>
<p>gets as its input parameter the name of a text file (without extension <code>.txt</code>) describing an instance of the process layout problem, and then calls <code>readData()</code> to read the instance.</p>
<p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Cproclayout::readData(<span class="keyword">const</span> <span class="keywordtype">char</span>* fileName)</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> k,m,n;</div><div class="line">    std::ifstream fin(fileName);</div><div class="line">    <span class="keywordflow">if</span> (!fin.is_open()) {</div><div class="line">        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="codeRef" doxygen="/home/nick/programs/mip/mipcl/docs/mipcl.tag:../../../mipcl/docs/html/" href="../../../mipcl/docs/html/classCFileException.html">CFileException</a>(<span class="stringliteral">&quot;Cproclayout::readData&quot;</span>,fileName);</div><div class="line">    }</div><div class="line">    fin &gt;&gt; n &gt;&gt; m;</div><div class="line">    m_iN=n; m_iM=m;</div><div class="line">    <span class="keywordflow">if</span> (!(m_ipMovingCost = <span class="keyword">new</span>(std::nothrow) <span class="keywordtype">int</span>[m*n + m*(m-1)/2 + n*(n-1)/2])) {</div><div class="line">        fin.close();</div><div class="line">        <span class="keywordflow">throw</span> <a class="codeRef" doxygen="/home/nick/programs/mip/mipcl/docs/mipcl.tag:../../../mipcl/docs/html/" href="../../../mipcl/docs/html/classCMemoryException.html">CMemoryException</a>(<span class="stringliteral">&quot;Cproclayout::readData&quot;</span>);</div><div class="line">    }</div><div class="line">    m_ipFlow=(m_ipDist=m_ipMovingCost+(n*n))+m*(m-1)/2;</div><div class="line"></div><div class="line">    k=m*n;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; k; ++i)</div><div class="line">        fin &gt;&gt;  m_ipMovingCost[i];</div><div class="line">    </div><div class="line">    k=m*(m-1)/2;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; k; ++i)</div><div class="line">        fin &gt;&gt;  m_ipDist[i];</div><div class="line"></div><div class="line">    k=n*(n-1)/2;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; k; ++i)</div><div class="line">        fin &gt;&gt;  m_ipFlow[i];</div><div class="line"></div><div class="line">    fin.close();</div><div class="line">} <span class="comment">// end of Cproclayout::readData</span></div></div><!-- fragment --></p>
<p>Our <b>MIPshell</b> implementation of IP (1) is straightforward.</p>
<div class="fragment"><div class="line">int Cproclayout::model()</div><div class="line">{</div><div class="line">    int i,j,s,r, n=m_iN, m=m_iM;</div><div class="line">    VAR_VECTOR x(&quot;x&quot;,BIN,n,m), y(&quot;y&quot;,BIN,n,n,m,m);</div><div class="line"></div><div class="line">    minimize(sum(i in [0,n), s in [0,m)) p(i,s)*x(i,s) +</div><div class="line">        sum(i in [0,n-1), j in [i+1,n), s in [0,m), r in [0,m)) c(i,j,s,r)*y(i,j,s,r));</div><div class="line">         </div><div class="line">    forall(i in [0,n))</div><div class="line">        sum(s in [0,m)) x(i,s) == 1;</div><div class="line">        </div><div class="line">    forall(s in [0,m))</div><div class="line">        sum(i in [0,n)) x(i,s) &lt;= 1;</div><div class="line">        </div><div class="line">    forall(i in [0,n-1), j in [i+1,n))</div><div class="line">        sum(s in [0,m), r in [0,m)) y(i,j,s,r) == 1; </div><div class="line"></div><div class="line">    forall(i in [0,n-1), j in [i+1,n), s in [0,m), r in [0,m))</div><div class="line">        2*y(i,j,s,r) - x(i,s) - x(j,r) &lt;= 0;</div><div class="line"></div><div class="line">    optimize();</div><div class="line">    printSol(x);</div><div class="line">    return 0;</div><div class="line">} // end of Cproclayout::model</div><div class="line"></div></div><!-- fragment --><p>Let us note, that <code>Cproclayout</code> has two simple functions <code>p()</code> and <code>c()</code> (not discussed here) that compute the costs <img class="formulaInl" alt="$p_{is}\text{ and } c_{ijsr}$" src="form_80.png"/></p>
<p>To print optimal solutions, in place of the standard <code><a class="el" href="Problem_8h.html#a71d33b1bbfc010c85e7d36ab2fe3f058" title="alias for CProblem::printFinalSolution() ">printsol()</a></code>, we developed another procedure, named <code>printSol()</code>, that prints the solutions in a more readable form.</p>
<h2><a class="anchor" id="Solving"></a>
illustrative example problem</h2>
<p>To solve this instance of the process layout problem, we described it in a text file (named <code>test1.txt</code>) whose contest is presented in the listing below.</p>
<p><b>Listing 1: <em>Input file for process~layout program</em></b> </p><pre class="fragment">8 8
  0 200 200 200 200 200 200 200
200   0 200 200 200 200 200 200
200 200   0 200 200 200 200 200
200 200 200   0 200 200 200 200
200 200 200 200   0 200 200 200
200 200 200 200 200   0 200 200
200 200 200 200 200 200   0 200
200 200 200 200 200 200 200   0

1 1 2 2 3 3 4
  2 1 3 2 4 3
    1 1 2 2 3
      2 1 3 2
        1 1 2
          2 1
            1

0 300 750 200 900 150  100
  100 500 100  35 115    0
        0 450 625 890  490
          375 450 475  400
                0 910  840
                  575 1625
                        40
</pre><p>To solve our instance process layout problem, enter the following commands: </p><pre class="fragment"> cd $MIPCLDIR/examples/mipcl/proclayout/tests
 $MIPCLDIR/examples/bin/proclayout test1
</pre><p>to get in the folder <em>tests</em> the text file named <em>test1.sol</em> with the content as that in the following listing.</p>
<p><b>Listing 2: <em>Solution for process-layout example</em></b> </p><pre class="fragment"> Total expenses: 18500
 i =&gt; s  means that department i moves to site s
 1 =&gt; 1
 2 =&gt; 2
 3 =&gt; 7
 4 =&gt; 4
 5 =&gt; 6
 6 =&gt; 3
 7 =&gt; 8
 8 =&gt; 5
</pre><p>We see that, if the factory reallocates its departments as it is prescribed in Listing&#160;2, it will profit $20375&#160;-&#160;185007&#160;=&#160;$1875$ during the planning horizon of five years. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
