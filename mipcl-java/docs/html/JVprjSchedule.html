<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JVmipcl: Project Scheduling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="MIPCLlogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JVmipcl
   &#160;<span id="projectnumber">1.4.0</span>
   </div>
   <div id="projectbrief">Mixed Integer Programming Class Library: java backend</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Project Scheduling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sec_JVprjSchedule"></a>
Project Scheduling</h1>
<p>Let us consider a project that consists of <em>n</em> jobs. There are <img class="formulaInl" alt="$q^r$" src="form_65.png"/> <em>renewable</em> (<em>non-perishable</em>) resources, with, respectively, <img class="formulaInl" alt="$R^r_i$" src="form_66.png"/> units of resource <em>i</em> available per unit of time. Renewable resources are available in the same quantities at any period. Manpower, machines, storage spaces are renewable resources. There are also <img class="formulaInl" alt="$q^n$" src="form_67.png"/> <em>nonrenewable</em> (<em>perishable</em>) resources, with, respectively, <img class="formulaInl" alt="$R^n_i$" src="form_68.png"/> units of resource <em>i</em> available for the entire project. In contrast to a renewable resource, which consumption is limited in each period, overall consumption of a nonrenewable resource is limited for the entire project. Money, energy, and raw materials are nonrenewable resources. It is assumed that all resources are available when the project starts.</p>
<p>Jobs can be processed in different modes. Execution of any job cannot be interrupted, thus, if processing of a job once started in some mode, it has to be completed in the same mode. If job <em>j</em> is processed in mode <em>m</em> ( <img class="formulaInl" alt="$m=1,\dots,M_j$" src="form_69.png"/>), then it takes <img class="formulaInl" alt="$p^m_j$" src="form_70.png"/> units of time to process the job, <img class="formulaInl" alt="$\rho^r_{jmi}$" src="form_71.png"/> units of renewable resource <em>i</em> ( <img class="formulaInl" alt="$i=1,\dots,q^r$" src="form_72.png"/>) are used each period job <em>j</em> is processed, and <img class="formulaInl" alt="$\rho^n_{jmi}$" src="form_73.png"/> units of nonrenewable resource <em>i</em> ( <img class="formulaInl" alt="$i=1,\dots,q^n$" src="form_74.png"/>) are totally consumed.</p>
<p><em>Precedence relations</em> between jobs are given by an acyclic digraph <img class="formulaInl" alt="$G=(\{1,\dots,n\},\mathcal{R})$" src="form_75.png"/> defined on the set of jobs: for any arc <img class="formulaInl" alt="$(j_1,j_2)\in \mathcal{R}$" src="form_76.png"/>, job <img class="formulaInl" alt="$j_2$" src="form_46.png"/> cannot start until job <img class="formulaInl" alt="$j_1$" src="form_47.png"/> is finished.</p>
<p>The goal is to find a schedule, which specifies when each job starts and in which mode it is processed, with the minimal makespan. The <em>makespan</em> of a schedule is defined to be the end time of the lastly finished job.</p>
<h2><a class="anchor" id="sec_JVprjShedIP"></a>
Integer Programming Formulation</h2>
<p>Let us assume that we know an upper bound, <em>H</em>, on the optimal makespan value. For example, we can take as <em>H</em> the makespan of a schedule produced by one of numerous project scheduling heuristics. The planning horizon is divided into <em>H</em> periods numbered from 1 to <em>H</em>, and period <em>t</em> starts at time <em>t</em>-1 and ends at time <em>t</em>.</p>
<p>To tighten our formulation, we can estimate (say, by the <em>critical path method</em>) the earliest, <img class="formulaInl" alt="$ef_j$" src="form_77.png"/> and latest, <img class="formulaInl" alt="$lf_j$" src="form_78.png"/>, finish times of all jobs <em>j</em>.</p>
<p>First, we define the family of decision binary variables:</p><ul>
<li><img class="formulaInl" alt="$x_{jmt}=1$" src="form_79.png"/> if job <em>j</em> is processed in mode <em>m</em> and completed at the end of period <em>t</em> (at time <em>t</em>); otherwise, <img class="formulaInl" alt="$x_{jmt}=0$" src="form_80.png"/>.</li>
</ul>
<p>For modeling purposes, we also need the following families of auxiliary variables:</p><ul>
<li><em>T</em>: schedule makespan;</li>
<li><img class="formulaInl" alt="$d_j\in\mathbb{R}$" src="form_81.png"/>: duration of job <em>j</em> ( <img class="formulaInl" alt="$d_j$" src="form_82.png"/> depends on the mode in which job <em>j</em> is processed);</li>
<li><img class="formulaInl" alt="$e_j\in\mathbb{R}$" src="form_83.png"/>: end time of job <em>j</em>.</li>
</ul>
<p>In these variables the model is written as follows:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align} T \to \min,&amp; \tag{1.a}\\ \sum_{m=1}^{M_j}\sum_{t=ef_j}^{lf_j} x_{jmt} = 1,\quad &amp;j=1,\dots,n,\tag{1.b}\\ e_j = \sum_{m=1}^{M_j}\sum_{t=ef_j}^{lf_j} t x_{jmt},\quad &amp;j=1,\dots,n,\tag{1.c}\\ d_j = \sum_{m=1}^{M_j}\sum_{t=ef_j}^{lf_j} p^m_j x_{jmt},\quad &amp;j=1,\dots,n,\tag{1.d}\\ T \ge e_j,\quad &amp;j=1,\dots,n,\tag{1.e}\\ \sum_{j=1}^n\sum_{m=1}^{M_j}\sum_{t=\max(\tau,ef_j)}^{\min(\tau+p^m_j,lf_j)} \rho^r_{jmi} x_{jmt} \le R^r_i, \quad i=1,\dots,q^r,\; &amp;\tau=1,\dots,H,\tag{1.f}\\ \sum_{j=1}^n\sum_{m=1}^{M_j}\sum_{t=ef_j}^{lf_j} \rho^n_{jmi} x_{jmt} \le R^n_i, \quad &amp;i=1,\dots,q^n,\tag{1.g}\\ e_{j_2} - e_{j_1} \ge d_{j_2},\quad &amp;(j_1,j_2)\in \mathcal{R},\tag{1.h}\\ e_j \ge d_j,\quad &amp; j=1,\dots,n,\label{1.i}\\ x_{jmt}\in \{0,1\},\quad t=0,\dots,H,\; m=1,\dots,M_j,\; &amp;j=1,\dots,n,\tag{1.j}\\ d_j, e_j \in\mathbb{R},\quad &amp;j=1,\dots,n.\tag{1.k} \end{align}" src="form_84.png"/>
</p>
<p>The objective (1.a) is to minimize the makespan. The equations (1.b) impose the requirement that each job is processed only in one mode, and it finishes (and starts) only once. For the schedule given by the values of <img class="formulaInl" alt="$x_{jmt}$" src="form_85.png"/> variables, the equations (1.c) and (1.d) calculate the end times and durations of all jobs. The inequalities (1.e) imply that, being minimized, <em>T</em> is the makespan of the schedule given by the values of <em>x</em>-variables. The inequalities (1.f) and (1.g) impose the limitations, respectively, on the renewable and nonrenewable resources. The precedence relations between jobs are given by the inequalities (1.h}). The last family of constraints, (1.i), are important only for jobs without predecessors; otherwise, starting times of such jobs could be negative.</p>
<h2><a class="anchor" id="sec_prjScheduleImpl"></a>
MIPCL-JAVA Implementation</h2>
<p>To solve instances of the project scheduling problem, we developed a package of Java classe, named <code>projectScheduling</code>. Let us start with considering data structures that describe projects.</p>
<h3><a class="anchor" id="sec_prjScheduleProject"></a>
Classes Resource, Mode, Job, and  Project</h3>
<p>First we present three simple structures that describe resources, processing modes, and jobs.</p>
 <div class="fragment"><div class="line"><span class="keyword">package </span>projectScheduling;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">class </span>Resource {</div><div class="line">        String name;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> quantity;</div><div class="line">} <span class="comment">// end of Resource</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>Mode {</div><div class="line">        <span class="keywordtype">int</span> duration;</div><div class="line"></div><div class="line">        Map&lt;Integer,Integer&gt; renRes;</div><div class="line"></div><div class="line">        Map&lt;Integer,Integer&gt; nonRenRes;</div><div class="line">} <span class="comment">// end of Mode</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>Job {</div><div class="line">        String name;</div><div class="line"></div><div class="line">        Mode[] modes;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span>[] prec;</div><div class="line">} <span class="comment">// end of Job</span></div></div><!-- fragment --></p>
<p>In our implementation, any project is given as an object of the <code>Project</code> class.</p>
<p><div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Project {</div><div class="line"></div><div class="line">        String name;</div><div class="line"></div><div class="line">        String getName()</div><div class="line">        {<span class="keywordflow">return</span> name;}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> horizon;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getHorizon()</div><div class="line">        {<span class="keywordflow">return</span> horizon;}</div><div class="line"></div><div class="line">        Resource[] renRes;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getRenResNum()</div><div class="line">        {<span class="keywordflow">return</span> (renRes != null)? renRes.length: 0;}</div><div class="line"></div><div class="line">        String getRenResName(<span class="keywordtype">int</span> i)</div><div class="line">        {<span class="keywordflow">return</span> renRes[i].name;}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getRenResQuantity(<span class="keywordtype">int</span> i)</div><div class="line">        {<span class="keywordflow">return</span> renRes[i].quantity;}</div><div class="line"></div><div class="line">        Resource[] nonRenRes;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getNonRenResNum()</div><div class="line">        {<span class="keywordflow">return</span> (nonRenRes != null)? nonRenRes.length: 0;}</div><div class="line"></div><div class="line">        String getNonRenResName(<span class="keywordtype">int</span> i)</div><div class="line">        {<span class="keywordflow">return</span> nonRenRes[i].name;}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getNonRenResQuantity(<span class="keywordtype">int</span> i)</div><div class="line">        {<span class="keywordflow">return</span> nonRenRes[i].quantity;}</div><div class="line"></div><div class="line">        Job[] jobs;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getJobNum()</div><div class="line">        {<span class="keywordflow">return</span> (jobs != null)? jobs.length: 0;}</div><div class="line"></div><div class="line">        String getJobName(<span class="keywordtype">int</span> j)</div><div class="line">        {<span class="keywordflow">return</span> jobs[j].name;}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getJobModeNum(<span class="keywordtype">int</span> j)</div><div class="line">        {<span class="keywordflow">return</span> jobs[j].modes.length;}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getJobDuration(<span class="keywordtype">int</span> j, <span class="keywordtype">int</span> m)</div><div class="line">        {<span class="keywordflow">return</span> jobs[j].modes[m].duration;}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getRenResForJob(<span class="keywordtype">int</span> j, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> i)</div><div class="line">        {</div><div class="line">                <span class="keywordtype">int</span> q = 0;</div><div class="line">                <span class="keywordflow">if</span> (jobs[j].modes[m].renRes != null) {</div><div class="line">                        Integer Q = jobs[j].modes[m].renRes.get(i);</div><div class="line">                        q = (Q != null)? Q: 0;</div><div class="line">                }</div><div class="line">                <span class="keywordflow">return</span> q;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getNonRenResForJob(<span class="keywordtype">int</span> j, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> i)</div><div class="line">        {</div><div class="line">                <span class="keywordtype">int</span> q = 0;</div><div class="line">                <span class="keywordflow">if</span> (jobs[j].modes[m].nonRenRes != null) {</div><div class="line">                        Integer Q = jobs[j].modes[m].nonRenRes.get(i);</div><div class="line">                        q = (Q != null)? Q: 0;</div><div class="line">                }</div><div class="line">                <span class="keywordflow">return</span> q;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span>[] getPrecJobs(<span class="keywordtype">int</span> j)</div><div class="line">        {<span class="keywordflow">return</span> jobs[j].prec;}</div><div class="line">} <span class="comment">// end of Project</span></div></div><!-- fragment --></p>
<p>We see that each project has a name. The <code>horizon</code> field gives the length of the planning horizon, which is an upper bound on the minimal makespan. Two arrays <code>renRes</code> and <code>nonRenRes</code> describe renewable and non-renewable resources needed by the jobs that constitute the project. The jobs are given by the array <code>jobs</code>. Each of the member-functions in <code>Project</code> provides a piece of data stored in data-members of <code>Project</code>.</p><ul>
<li><code>getName()</code>: returns project name;</li>
<li><code>getHorizon()</code>: length of the planning horizon;</li>
<li><code>getRenResNum()</code>: number of renewable resources;</li>
<li><code>getRenResName(i)</code>: name of renewable resource <code>i</code>;</li>
<li><code>getRenResQuantity(i)</code>: returns available quantity of renewable resource <code>i</code>;</li>
<li><code>getNonRenResNum()</code>: number of non-renewable resources;</li>
<li><code>getNonRenResName(i)</code>: name of non-renewable resource <code>i</code>;</li>
<li><code>getNonRenResQuantity(i)</code>: returns available quantity of non-renewable resource <code>i</code>;</li>
<li><code>getJobNum()</code>: return number of jobs in the project;</li>
<li><code>getJobName(j)</code>: returns name of job indexed by <code>j</code>;</li>
<li><code>getJobModeNum(j)</code>: returns number of modes available for processing job <code>j</code>;</li>
<li><code>getJobDuration(j,m)</code>: returns processing time of job <code>j</code> in mode <code>m</code>;</li>
<li><code>getRenResForJob(j,m,i)</code>: returns number of units of renewable resource <code>i</code> used by job <code>j</code> in mode <code>m</code>;</li>
<li><code>getNonRenResForJob(j,m,i)</code>: return number of units of non-renewable resource <code>i</code> used by job <code>j</code> in mode <code>m</code>;</li>
<li><code>getPrecJobs(j)</code>: returns array (list) of jobs preceding to job <code>j</code>.</li>
</ul>
<h3><a class="anchor" id="sec_classProjectSchedule"></a>
Class ProjectSchedule</h3>
<p>In this section we discuss our main class, named <code>ProjectSchedule</code>, that implements MIP (1).  <div class="fragment"><div class="line"><span class="keyword">package </span>projectScheduling;</div><div class="line"></div><div class="line"><span class="keyword">import</span> <a class="code" href="namespaceby.html">by</a>.<a class="code" href="namespaceby_1_1bsu.html">bsu</a>.<a class="code" href="namespaceby_1_1bsu_1_1JVmipshell.html">JVmipshell</a>.*;</div><div class="line"><span class="keyword">import</span> java.util.<a class="code" href="classjava_1_1util_1_1List.html">List</a>;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"><span class="keyword">import</span> java.util.Collections;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>ProjectSchedule <span class="keyword">extends</span> MIPshell</div><div class="line">{</div><div class="line">        <span class="keyword">static</span> {</div><div class="line">                System.loadLibrary(<span class="stringliteral">&quot;JVmipcl&quot;</span>);</div><div class="line">        }</div><div class="line">        </div><div class="line">        Project prj;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> H;</div><div class="line">        </div><div class="line">        <span class="keywordtype">int</span> n;</div><div class="line">        </div><div class="line">        <span class="keywordtype">int</span> renResNum;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> nonRenResNum;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> makeSpan;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span>[] ef, lf;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span>[] mode;</div><div class="line"></div><div class="line">        List&lt;List&lt;Map&lt;Integer,Var&gt;&gt;&gt; x;</div></div><!-- fragment --></p>
<p>Here the static block loads the <b>JVmipcl</b> library (<code>mipcl.so</code> in Linux, or <code>mipcl.dll</code> in Windows)</p>
<p><b>Data member of <code>ProjectSchedule</code></b>:</p><ul>
<li><code>prj</code>: project to be scheduled;</li>
<li><code>H</code>: upper bound for the minimum makespan;</li>
<li><code>n</code>: number of jobs;</li>
<li><code>renResNum</code>: number of renewable resources;</li>
<li><code>nonRenResNum</code>: number of non-renewable resources;</li>
<li><code>makeSpan</code>: optimal value of makespan;</li>
<li><code>ef</code>, <code>lf</code>: in optimization phase, <code>ef[j]</code> and <code>lf[j]</code> are, respectively, early and late finish time of job <code>j</code>; when a solution has been found, <code>getSchedule()</code> sets <code>ef[j]</code> to be the finish time of job <code>j</code>;</li>
<li><code>mode</code>: when a solution has been found, <code>getSchedule()</code> sets <code>mode[j]</code> to be the processing mode of job <code>j</code>; it should be noted that <code>mode</code> and <code>lf</code> are references to the same object;</li>
<li><code>x</code>: this object represents <em>x</em>-variables in MIP (1).</li>
</ul>
<p><b>The constructor</b></p>
<p><div class="fragment"><div class="line">        <span class="keyword">public</span> ProjectSchedule(Project prj)</div><div class="line">        {</div><div class="line">                super(prj.getName());</div><div class="line">                this.prj = prj;</div><div class="line">                H = prj.getHorizon();</div><div class="line">                n = prj.getJobNum();</div><div class="line">                renResNum = prj.getRenResNum();</div><div class="line">                nonRenResNum = prj.getNonRenResNum();</div><div class="line">                ef = lf = mode = null;</div><div class="line">                x = null;</div><div class="line">        } <span class="comment">// end of ProjectSchedule()</span></div></div><!-- fragment --></p>
<p>This construcor invokes the constructor of the base class, sets the reference to the project to be scheduled, and gets some parameters of that project.</p>
<p><b>Member functions</b></p>
<p><div class="fragment"><div class="line">        <span class="keywordtype">int</span> p(<span class="keywordtype">int</span> j, <span class="keywordtype">int</span> m) {<span class="keywordflow">return</span> prj.getJobDuration(j,m);}</div><div class="line">    </div><div class="line">        <span class="keywordtype">int</span> R_r(<span class="keywordtype">int</span> i) {<span class="keywordflow">return</span> prj.getRenResQuantity(i);}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> rho_r(<span class="keywordtype">int</span> j, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> i) {<span class="keywordflow">return</span> prj.getRenResForJob(j,m,i);}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> R_n(<span class="keywordtype">int</span> i) {<span class="keywordflow">return</span> prj.getNonRenResQuantity(i);}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> rho_n(<span class="keywordtype">int</span> j, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> i) {<span class="keywordflow">return</span> prj.getNonRenResForJob(j,m,i);}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> M(<span class="keywordtype">int</span> j) {<span class="keywordflow">return</span> prj.getJobModeNum(j);}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span>[] prec(<span class="keywordtype">int</span> j) {<span class="keywordflow">return</span> prj.getPrecJobs(j);}</div></div><!-- fragment --></p>
<p>The above functions do the following:</p><ul>
<li><code>p(j,m)</code>: returns processing time of job <code>j</code> in mode <code>m</code>;</li>
<li><code>R_r(i)</code>: returns number of units of renewable resource <code>i</code> available;</li>
<li><code>rho_r(j,m,i)</code>: returns number of units of renewable resource <code>i</code> used when processing job <code>j</code> in mode <code>m</code>;</li>
<li><code>R_n(i)</code>: returns number of units of non-renewable resource <code>i</code> available;</li>
<li><code>rho_n(j,m,i)</code>: returns number of units of renewable resource <code>i</code> used when processing job <code>j</code> in mode <code>m</code>;</li>
<li><code>M(j)</code>: returns number of processing modes for job <code>j</code>;</li>
<li><code>prec(j)</code>: returns array (list) of preceding jobs for job <code>j</code>.</li>
</ul>
<p><b>Computing job early and late finish times</b></p>
<p><div class="fragment"><div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> cpm(<span class="keywordtype">int</span> H)</div><div class="line">        {</div><div class="line">                ef = <span class="keyword">new</span> <span class="keywordtype">int</span>[n];</div><div class="line">                lf = <span class="keyword">new</span> <span class="keywordtype">int</span>[n];</div><div class="line"></div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) { <span class="comment">// compute job early start times</span></div><div class="line">                        <span class="keywordtype">int</span> es = 0;</div><div class="line">                        <span class="keywordflow">if</span> (prec(j) != null) {</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j1 : prec(j)) {</div><div class="line">                                        <span class="keywordflow">if</span> (es &lt; ef[j1])</div><div class="line">                                                es = ef[j1];</div><div class="line">                                }</div><div class="line">                        }</div><div class="line">                        <span class="keywordtype">int</span> minDur = H;</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m &lt; M(j); ++m) {</div><div class="line">                                <span class="keywordtype">int</span> d = p(j,m);</div><div class="line">                                <span class="keywordflow">if</span> (minDur &gt; d)</div><div class="line">                                        minDur = d;</div><div class="line">                        }</div><div class="line">                        ef[j] = es + minDur;</div><div class="line">                        lf[j] = H;</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=n; --j &gt;= 0; ) {</div><div class="line">                        <span class="keywordtype">int</span> minDur = H;</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m &lt; M(j); ++m) {</div><div class="line">                                <span class="keywordtype">int</span> d = p(j,m);</div><div class="line">                                <span class="keywordflow">if</span> (minDur &gt; d)</div><div class="line">                                        minDur = d;</div><div class="line">                        }</div><div class="line">                        <span class="keywordtype">int</span> ls = lf[j] - minDur;</div><div class="line">                        <span class="keywordflow">if</span> (prec(j) != null) {</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j1 : prec(j)) {</div><div class="line">                                        <span class="keywordflow">if</span> (lf[j1] &gt; ls)</div><div class="line">                                                lf[j1] = ls;</div><div class="line">                                }</div><div class="line">                        }</div><div class="line">                }</div><div class="line">        } <span class="comment">// end of cpm()</span></div></div><!-- fragment --></p>
<p>The <code>cpm()</code> procedure, which implements the critical path method, computes the lower bounds, <code>ef[j]</code>, on the early job finish times by the following recurrent formulas: </p><pre class="fragment">ef[j] = 0 if prec(j) is empty,
ef[j] = max{ef[j1] + d[j]: j1 in prec(j)},
where d[j] = min{p(j,m): m in M(j)}.
</pre><p>The upper bounds on the job late finish times &mdash; subject to the condition the project has to be finished during the time horizon of <code>H</code> periods &mdash; are computed by the formulas: </p><pre class="fragment">ef[j] = H if j has not successors (j is not in prec(j1) for any job j1),
ef[j] = max{ef[j1] - d[j]: j in prec(j1)},
where d[j] = min{p(j,m): m in M(j)}. 
</pre><p><b>The model</b></p>
<p>As usual, we have implementation MIP (1) in the function called <code>model()</code>.</p>
<p><div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> model()</div><div class="line">        {</div><div class="line">                cpm(H);</div><div class="line"> </div><div class="line">                Var T = <span class="keyword">new</span> Var(<span class="keyword">this</span>,<span class="stringliteral">&quot;T&quot;</span>,VAR_INT);</div><div class="line">                VarVector e = <span class="keyword">new</span> VarVector(<span class="keyword">this</span>,<span class="stringliteral">&quot;e&quot;</span>,VAR_INT,n);</div><div class="line">                VarVector d = <span class="keyword">new</span> VarVector(<span class="keyword">this</span>,<span class="stringliteral">&quot;d&quot;</span>,VAR_INT,n);</div><div class="line">                </div><div class="line">                x = <span class="keyword">new</span> ArrayList&lt;List&lt;Map&lt;Integer,Var&gt;&gt;&gt;(n);</div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                        x.add(<span class="keyword">new</span> ArrayList&lt;Map&lt;Integer,Var&gt;&gt;(M(j)));</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m &lt; M(j); ++m) {</div><div class="line">                                x.get(j).add(<span class="keyword">new</span> HashMap&lt;Integer,Var&gt;());</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=ef[j]; t &lt;= lf[j]; ++t) {</div><div class="line">                                        x.get(j).get(m).put(t,<span class="keyword">new</span> Var(<span class="keyword">this</span>,<span class="stringliteral">&quot;x(&quot;</span>+j+<span class="stringliteral">&quot;,&quot;</span>+m+<span class="stringliteral">&quot;,&quot;</span>+t+<span class="stringliteral">&quot;)&quot;</span>,VAR_BIN));</div><div class="line">                                }</div><div class="line">                        }</div><div class="line">                }</div><div class="line"></div><div class="line">                LinSum lsum, lsum1, lsum2;</div></div><!-- fragment --></p>
<p>In the above fragment of code, we create all the variables of MIP (1). The last line declares three references to the <code>LinSum</code> objects, which are used for posing constraints.</p>
<p>The next fragment of code first defines the objective, and then builds the constraints (1.b)&ndash;(1.e).</p>
<p><div class="fragment"><div class="line">                minimize(T);</div><div class="line"></div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                        lsum = <span class="keyword">new</span> LinSum();</div><div class="line">                        lsum1 = <span class="keyword">new</span> LinSum();</div><div class="line">                        lsum2 = <span class="keyword">new</span> LinSum();</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m &lt; M(j); ++m) {</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=ef[j]; t &lt;= lf[j]; ++t) {</div><div class="line">                                        lsum.add(1.0,x.get(j).get(m).get(t));</div><div class="line">                                        lsum1.add(p(j,m),x.get(j).get(m).get(t));</div><div class="line">                                        lsum2.add(t,x.get(j).get(m).get(t));</div><div class="line">                                }</div><div class="line">                        }</div><div class="line">                        addCtr(lsum,1.0,1.0); <span class="comment">// each job ends only once and is processd in only one mode</span></div><div class="line">                        addCtr(lsum1.add(-1.0,d.get(j)),0.0,0.0); <span class="comment">// sets duration of job j </span></div><div class="line">                        addCtr(lsum2.add(-1.0,e.get(j)),0.0,0.0); <span class="comment">// sets completion time of job j</span></div><div class="line">                        </div><div class="line">                        lsum = <span class="keyword">new</span> LinSum();</div><div class="line">                        addCtr(lsum.add(1.0,e.get(j)).add(-1.0,T),-INF,0.0); <span class="comment">// sets makespan: T &gt;= e[j]</span></div><div class="line">                } <span class="comment">// for (int j=0; j &lt; n; ++j)</span></div></div><!-- fragment --></p>
<p>Next, the code block follows that builds the constraints (1.f) posing the limits on the usage of renewable resources.</p>
<p><div class="fragment"><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tau=1; tau &lt;= H; ++tau) {</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; renResNum; ++i) {</div><div class="line">                                lsum = <span class="keyword">new</span> LinSum();</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m &lt; M(j); ++m) {</div><div class="line">                                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=max(tau,ef[j]); t &lt;= min(tau+p(j,m),lf[j]); ++t) {</div><div class="line">                                                        lsum.add(rho_r(j,m,i),x.get(j).get(m).get(t));</div><div class="line">                                                }</div><div class="line">                                        }</div><div class="line">                                }</div><div class="line">                                addCtr(lsum,-INF,R_r(i));</div><div class="line">                        }</div><div class="line">                } <span class="comment">// for (int tau=1; tau &lt;= H; ++tau)</span></div></div><!-- fragment --></p>
<p>The limits on the usage of non-renewable resources &mdash; given by the inequalities (1.h) &mdash; are established by the following code.</p>
<p><div class="fragment"><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; nonRenResNum; ++i) {</div><div class="line">                        lsum = <span class="keyword">new</span> LinSum();</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m &lt; M(j); ++m) {</div><div class="line">                                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=ef[j]; t &lt;= lf[j]; ++t) {</div><div class="line">                                                lsum.add(rho_n(j,m,i),x.get(j).get(m).get(t));</div><div class="line">                                        }</div><div class="line">                                }</div><div class="line">                        }</div><div class="line">                        addCtr(lsum,-INF,R_n(i));</div><div class="line">                } <span class="comment">// for (int i=0; i &lt; nonRenResNum; ++i)</span></div></div><!-- fragment --></p>
<p>Now it is left to enforce the precedence relations given by the constraints (1.g). This is done in the code below.</p>
<p><div class="fragment"><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j2=0; j2 &lt; n; ++j2) {</div><div class="line">                        <span class="keywordflow">if</span> (prec(j2) != null) {</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j1 : prec(j2)) {</div><div class="line">                                        lsum = <span class="keyword">new</span> LinSum();</div><div class="line">                                        addCtr(lsum.add(1.0,e.get(j1)) <span class="comment">// e[j1] &lt;= e[j2] - d[j2]</span></div><div class="line">                                                   .add(-1.0,e.get(j2))</div><div class="line">                                                   .add(1.0,d.get(j2)),-INF,0.0);</div><div class="line">                                }</div><div class="line">                        }</div><div class="line">                        <span class="keywordflow">else</span> { <span class="comment">// j2 has not predecessors</span></div><div class="line">                                lsum = <span class="keyword">new</span> LinSum();</div><div class="line">                                addCtr(lsum.add(1.0,e.get(j2)) <span class="comment">// e[j2] &gt;= d[j2]</span></div><div class="line">                                           .add(-1.0,d.get(j2)),0.0,INF);</div><div class="line">                        }</div><div class="line">                }</div><div class="line">        } <span class="comment">// end of model()</span></div></div><!-- fragment --></p>
<p><b>Store the schedule</b></p>
<p><div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> getSchedule()</div><div class="line">        {</div><div class="line">                <span class="keywordflow">if</span> (isSolution()) {</div><div class="line">                        mode = lf;</div><div class="line">                        makeSpan = (int)(getobjVal() + 0.5);</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                                <span class="keywordtype">boolean</span> stop = <span class="keyword">false</span>;</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m &lt; M(j); ++m) {</div><div class="line">                                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=ef[j]; t &lt;= lf[j]; ++t) {</div><div class="line">                                                <span class="keywordflow">if</span> (x.get(j).get(m).get(t).getval() &gt; 0.5) {</div><div class="line">                                                        mode[j] = m;</div><div class="line">                                                        ef[j] = t;</div><div class="line">                                                        stop = <span class="keyword">true</span>;</div><div class="line">                                                        <span class="keywordflow">break</span>;</div><div class="line">                                                }</div><div class="line">                                        }</div><div class="line">                                        <span class="keywordflow">if</span> (stop == <span class="keyword">true</span>)</div><div class="line">                                                <span class="keywordflow">break</span>;</div><div class="line">                                }</div><div class="line">                        }</div><div class="line">                }</div><div class="line">        } <span class="comment">// end of getSchedule()</span></div></div><!-- fragment --></p>
<p>The above procedure "extracts" an optimal schedule from the values of <code>x</code>-variables. The schedule is strored in two arrays, <code>ef</code> and <code>mode</code>: job <code>j</code> is processed in mode <code>mode[j]</code>, it starts at <code>ef[j]-p(j,mode(j))</code> and ends at <code>ef[j]</code>.</p>
<p><b>Resource consumption</b></p>
<p><div class="fragment"><div class="line">        <span class="keywordtype">int</span> getNonRenResUse(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> t)</div><div class="line">        {</div><div class="line">                <span class="keywordtype">int</span> q=0;</div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                        <span class="keywordflow">if</span> ( t &gt; ef[j]-p(j,mode[j]) &amp;&amp; t &lt;= ef[j])</div><div class="line">                                q += rho_r(j,mode[j],i);</div><div class="line">                }</div><div class="line">                <span class="keywordflow">return</span> q;</div><div class="line">        } <span class="comment">// end of getNonRenResUse()</span></div></div><!-- fragment --></p>
<p>The above procedure computes and then returns the amount of resource <code>i</code> used in period <code>t</code>.</p>
<p><b>Print the schedule</b></p>
<p><div class="fragment"><div class="line">        <span class="keyword">static</span> String repeatChar(String c, <span class="keywordtype">int</span> count)</div><div class="line">        {</div><div class="line">                <span class="keywordflow">return</span> String.join(<span class="stringliteral">&quot;&quot;</span>, Collections.nCopies(count, c));</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> printSchedule()</div><div class="line">        {</div><div class="line">                <span class="keywordflow">if</span> (isSolution()) {</div><div class="line">                        String optSol = (isSolutionOptimal())? <span class="stringliteral">&quot;optimality proven&quot;</span>: <span class="stringliteral">&quot;optimality not proven&quot;</span>;</div><div class="line">                        System.out.printf(<span class="stringliteral">&quot;Makespan = %6d - %s%n&quot;</span>,makeSpan,optSol);</div><div class="line">                        System.out.println(<span class="stringliteral">&quot;Job schedule:&quot;</span>);</div><div class="line">                        System.out.println(<span class="stringliteral">&quot; _______________________________&quot;</span>);</div><div class="line">                        System.out.println(<span class="stringliteral">&quot;|  Job | Mode |  Start |    End |&quot;</span>);</div><div class="line">                        System.out.println(<span class="stringliteral">&quot;|------+------+--------+--------|&quot;</span>);</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                                System.out.printf(<span class="stringliteral">&quot;| %4d | %4d | %6d | %6d |%n&quot;</span>,j,mode[j],ef[j]-p(j,mode[j]),ef[j]);</div><div class="line">                        }</div><div class="line">                        System.out.println(<span class="stringliteral">&quot; -------------------------------&quot;</span>);</div><div class="line"></div><div class="line">                        System.out.printf(<span class="stringliteral">&quot;%nResource usage:%n&quot;</span>);</div><div class="line">                        System.out.println(<span class="stringliteral">&quot; _____&quot;</span> + repeatChar(<span class="stringliteral">&quot;_&quot;</span>,9*renResNum));</div><div class="line">                        System.out.print(<span class="stringliteral">&quot;| Period |&quot;</span>);</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; renResNum; ++i) {</div><div class="line">                                System.out.printf(<span class="stringliteral">&quot; %5d |&quot;</span>,i);</div><div class="line">                        }</div><div class="line">                        System.out.printf(<span class="stringliteral">&quot;%n|--------&quot;</span>);</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; renResNum; ++i) {</div><div class="line">                                System.out.print(<span class="stringliteral">&quot;+-------&quot;</span>);</div><div class="line">                        }</div><div class="line">                        System.out.println(<span class="stringliteral">&quot;|&quot;</span>);</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=1; t &lt;= makeSpan; ++t) {</div><div class="line">                                System.out.printf(<span class="stringliteral">&quot;| %6d |&quot;</span>,t);</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; renResNum; ++i) {</div><div class="line">                                        System.out.printf(<span class="stringliteral">&quot; %5d |&quot;</span>,getNonRenResUse(i,t));</div><div class="line">                                }</div><div class="line">                                System.out.println(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                        }</div><div class="line">                        System.out.println(<span class="stringliteral">&quot; -----&quot;</span> + repeatChar(<span class="stringliteral">&quot;-&quot;</span>,9*renResNum));</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span> {</div><div class="line">                        <span class="keywordflow">if</span> (isInfeasible())</div><div class="line">                                System.out.println(<span class="stringliteral">&quot;Problem is infeasible&quot;</span>);</div><div class="line">                        <span class="keywordflow">else</span>                            </div><div class="line">                                System.out.println(<span class="stringliteral">&quot;Time limit reached, no solution has been found&quot;</span>);</div><div class="line">                }</div><div class="line">        } <span class="comment">// end of printSchedule() </span></div></div><!-- fragment --></p>
<p>The procedure <code>printSchedule()</code> prints the schedule found by the solver. It uses an auxiliary function <code>repeatChar()</code> that returns the string which is composed of <code>count</code> copies of input string <code>c</code>.</p>
<h2><a class="anchor" id="prjSchedule_using"></a>
Using `projectSchedule`</h2>
<p>In this section we present an applications that solves project scheduling problems written in text files in the <em>json</em> format. To understand the format of input files, it is enough to look at one of them displayed below. </p><div class="fragment"><div class="line">{</div><div class="line">  &quot;name&quot;: &quot;project0&quot;,</div><div class="line">  &quot;horizon&quot;: 36,</div><div class="line">    &quot;renRes&quot;: [</div><div class="line">        {&quot;name&quot;: &quot;1&quot;, &quot;quantity&quot;: 6},</div><div class="line">        {&quot;name&quot;: &quot;2&quot;, &quot;quantity&quot;: 7},</div><div class="line">        {&quot;name&quot;: &quot;3&quot;, &quot;quantity&quot;: 6}</div><div class="line">    ],</div><div class="line">  &quot;nonRenRes&quot;: [{&quot;nane&quot;: &quot;1&quot;, &quot;quantity&quot;: 3}],</div><div class="line">  &quot;jobs&quot;: [</div><div class="line">     {</div><div class="line">       &quot;name&quot;: &quot;0&quot;,</div><div class="line">       &quot;modes&quot;: [</div><div class="line">           {&quot;duration&quot;: 3, &quot;renRes&quot;: {0: 3, 1: 2, 2: 1}, &quot;nonRenRes&quot;: null},</div><div class="line">           {&quot;duration&quot;: 2, &quot;renRes&quot;: {0: 3, 1: 2, 2: 4}, &quot;nonRenRes&quot;: {0: 1}}</div><div class="line">       ],</div><div class="line">       &quot;prec&quot;: null</div><div class="line">     },</div><div class="line">     {</div><div class="line">       &quot;name&quot;: &quot;1&quot;,</div><div class="line">       &quot;modes&quot;: [{&quot;duration&quot;: 5, &quot;renRes&quot;: {0: 2, 1: 4, 2: 2}, &quot;nonRenRes&quot;: null}],</div><div class="line">       &quot;prec&quot;: null</div><div class="line">     },</div><div class="line">     {</div><div class="line">       &quot;name&quot;: &quot;2&quot;,</div><div class="line">       &quot;modes&quot;: [{&quot;duration&quot;: 6, &quot;renRes&quot;: {0: 3, 1: 1, 2: 2}, &quot;nonRenRes&quot;: null}],</div><div class="line">       &quot;prec&quot;: [0]</div><div class="line">     },</div><div class="line">     {</div><div class="line">       &quot;name&quot;: &quot;3&quot;,</div><div class="line">       &quot;modes&quot;: [{&quot;duration&quot;: 2, &quot;renRes&quot;: {0: 4, 1: 3, 2: 1}, &quot;nonRenRes&quot;: null}],</div><div class="line">       &quot;prec&quot;: [0]</div><div class="line">     },</div><div class="line">     {</div><div class="line">       &quot;name&quot;: &quot;4&quot;,</div><div class="line">       &quot;modes&quot;: [{&quot;duration&quot;: 3, &quot;renRes&quot;: {0: 2, 2: 3}, &quot;nonRenRes&quot;: null}],</div><div class="line">       &quot;prec&quot;: [3]</div><div class="line">     },</div><div class="line">     {</div><div class="line">       &quot;name&quot;: &quot;5&quot;,</div><div class="line">       &quot;modes&quot;: [{&quot;duration&quot;: 3, &quot;renRes&quot;: {0: 1, 1: 1, 2: 1}, &quot;nonRenRes&quot;: null}],</div><div class="line">       &quot;prec&quot;: [3]</div><div class="line">     },</div><div class="line">     {</div><div class="line">       &quot;name&quot;: &quot;6&quot;,</div><div class="line">       &quot;modes&quot;: [</div><div class="line">          {&quot;duration&quot;: 4, &quot;renRes&quot;: {0: 3, 1: 1, 2: 1}, &quot;nonRenRes&quot;: null},</div><div class="line">          {&quot;duration&quot;: 3, &quot;renRes&quot;: {0: 3, 1: 2, 2: 1}, &quot;nonRenRes&quot;: {0: 1}}</div><div class="line">       ],</div><div class="line">       &quot;prec&quot;: [1]</div><div class="line">     },</div><div class="line">     {</div><div class="line">       &quot;name&quot;: &quot;7&quot;,</div><div class="line">       &quot;modes&quot;: [</div><div class="line">                {&quot;duration&quot;: 4, &quot;renRes&quot;: {0: 3, 1: 2, 2: 3}, &quot;nonRenRes&quot;: null},</div><div class="line">                {&quot;duration&quot;: 2, &quot;renRes&quot;: {0: 3, 1: 3, 2: 3}, &quot;nonRenRes&quot;: {0: 1}}</div><div class="line">        ],</div><div class="line">       &quot;prec&quot;: [2]</div><div class="line">     },</div><div class="line">     {</div><div class="line">       &quot;name&quot;: &quot;8&quot;,</div><div class="line">       &quot;modes&quot;: [{&quot;duration&quot;: 2, &quot;renRes&quot;: {0: 4, 1: 1}, &quot;nonRenRes&quot;: null}],</div><div class="line">       &quot;prec&quot;: [4,7]</div><div class="line">     },</div><div class="line">     {</div><div class="line">       &quot;name&quot;: &quot;9&quot;,</div><div class="line">       &quot;modes&quot;: [</div><div class="line">                {&quot;duration&quot;: 5, &quot;renRes&quot;: {0: 2, 1: 2, 2: 2}, &quot;nonRenRes&quot;: null},</div><div class="line">                {&quot;duration&quot;: 3, &quot;renRes&quot;: {0: 3, 1: 2, 2: 3}, &quot;nonRenRes&quot;: {0: 1}}</div><div class="line">        ],</div><div class="line">       &quot;prec&quot;: [5,6]</div><div class="line">     },</div><div class="line">     {</div><div class="line">       &quot;name&quot;: &quot;10&quot;,</div><div class="line">       &quot;modes&quot;: [{&quot;duration&quot;: 3, &quot;renRes&quot;: {0: 5, 1: 4, 2: 2}, &quot;nonRenRes&quot;: null}],</div><div class="line">       &quot;prec&quot;: [8]</div><div class="line">     }</div><div class="line">  ]</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p>The main class of our application, called <code>testProjectSchedule</code>, is implemented as follows. </p><div class="fragment"><div class="line"><span class="keyword">package </span>projectScheduling;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.Reader;</div><div class="line"><span class="keyword">import</span> java.io.FileReader;</div><div class="line"><span class="keyword">import</span> com.google.gson.Gson;</div><div class="line"><span class="keyword">import</span> com.google.gson.GsonBuilder;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>testProjectSchedule {</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> main(String[] args) {</div><div class="line">                <span class="keywordflow">try</span> {</div><div class="line">                        Project prj = readProject(args[0]);</div><div class="line">                        ProjectSchedule sh = <span class="keyword">new</span> ProjectSchedule(prj);</div><div class="line">                        sh.model();</div><div class="line">                        sh.optimize();</div><div class="line">                        sh.getSchedule();</div><div class="line">                        sh.printSchedule();             </div><div class="line">                } <span class="keywordflow">catch</span>(Throwable e) {</div><div class="line">                        e.printStackTrace();</div><div class="line">                }</div><div class="line">        }</div><div class="line">        </div><div class="line">        <span class="keyword">static</span> Project readProject(String fileName) <span class="keywordflow">throws</span> IOException {</div><div class="line">                Project prj = null;</div><div class="line">                Reader reader = null;</div><div class="line">                <span class="keywordflow">try</span> {</div><div class="line">                        reader = <span class="keyword">new</span> FileReader(fileName);</div><div class="line">                        Gson gson = <span class="keyword">new</span> GsonBuilder().create();</div><div class="line">                        prj = gson.fromJson(reader, Project.class);</div><div class="line">                } <span class="keywordflow">finally</span> {</div><div class="line">                        <span class="keywordflow">if</span> (reader != null)</div><div class="line">                                reader.close();</div><div class="line">                }</div><div class="line">                <span class="keywordflow">return</span> prj;</div><div class="line">        }</div><div class="line">}</div></div><!-- fragment --><p>The <code>main()</code> function first reads an instance of the project scheduling problem into an object of the <code>Project</code> class. This is done by calling <code>readProject()</code>, which implementation is surprisingly simple and short. Then, <code>main()</code> creates and object of the <code>projectSchedule</code> class. After that, it calls <code>model()</code> to builds the <code>MIPshell</code> model, which is then optimized with the call to <code>optimize()</code>. Then <code>getSchedule()</code> is called to get the schedule from the values of <em>x</em>-variables. The schedule is printed by the call to <code>printSchedule()</code>.</p>
<p>In Linux, to compile this test application, do the following: </p><pre class="fragment"> cd $MIPCLDIR/mipcl-java/examples/projectScheduling
 ./compile
</pre><p>If we run our test program </p><pre class="fragment"> ./run tests/test0.json
</pre><p>with input parameter set to <code>tests/test0.json</code>, we get the following schedule: </p><pre class="fragment">Makespan =     23 - optimality proven
Job schedule:
 _______________________________
|  Job | Mode |  Start |    End |
|------+------+--------+--------|
|    0 |    1 |      0 |      2 |
|    1 |    0 |      0 |      5 |
|    2 |    0 |      7 |     13 |
|    3 |    0 |      3 |      5 |
|    4 |    0 |     10 |     13 |
|    5 |    0 |     11 |     14 |
|    6 |    1 |      6 |      9 |
|    7 |    1 |     14 |     16 |
|    8 |    0 |     17 |     19 |
|    9 |    0 |     14 |     19 |
|   10 |    0 |     20 |     23 |
 -------------------------------

Resource usage:
 ________________________________
| Period |     0 |     1 |     2 |
|--------+-------+-------+-------|
|      1 |     5 |     6 |     6 |
|      2 |     5 |     6 |     6 |
|      3 |     2 |     4 |     2 |
|      4 |     6 |     7 |     3 |
|      5 |     6 |     7 |     3 |
|      6 |     0 |     0 |     0 |
|      7 |     3 |     2 |     1 |
|      8 |     6 |     3 |     3 |
|      9 |     6 |     3 |     3 |
|     10 |     3 |     1 |     2 |
|     11 |     5 |     1 |     5 |
|     12 |     6 |     2 |     6 |
|     13 |     6 |     2 |     6 |
|     14 |     1 |     1 |     1 |
|     15 |     5 |     5 |     5 |
|     16 |     5 |     5 |     5 |
|     17 |     2 |     2 |     2 |
|     18 |     6 |     3 |     2 |
|     19 |     6 |     3 |     2 |
|     20 |     0 |     0 |     0 |
|     21 |     5 |     4 |     2 |
|     22 |     5 |     4 |     2 |
|     23 |     5 |     4 |     2 |
 --------------------------------
</pre><p><b>Remark</b>: On Windows computers, to compile applications and then run tests, we execute two batch files <code>compile.bat</code> and <code>run.but</code>.</p>
<p>Alternatively, if you prefer using <b>ant</b>, both, in Linux and Windows, to compile and then run our test program, type the following commands: </p><pre class="fragment">ant jar
ant run -Dfilename=tests/test1.json</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 12 2017 00:28:59 for JVmipcl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
