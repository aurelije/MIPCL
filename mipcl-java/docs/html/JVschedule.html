<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JVmipcl: Scheduling Problems</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="MIPCLlogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JVmipcl
   &#160;<span id="projectnumber">1.4.0</span>
   </div>
   <div id="projectbrief">Mixed Integer Programming Class Library: java backend</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Scheduling Problems </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sec_JVschedule"></a>
Scheduling Problems</h1>
<p>In a scheduling problem we have to fulfill a set of jobs on a number of processors using other resources under certain constraints such as restrictions on the job completion times, priorities between jobs (one job cannot start until another one is finished), and etc. The goal is to optimize some criterion, e.g, to minimize the total processing time, which is the completion time of the last job (assuming that the first task starts at time 0); or to maximize the number of processed jobs.</p>
<p>Next we formulate a very general <em>scheduling problem</em> which subsumes as special cases a great deal of scheduling problems studied in the literature. We are given <em>n</em> jobs to be processed on <em>m</em> processors (machines). Let <img class="formulaInl" alt="$\mathcal{M}_j\subseteq \mathcal{P}=\{1,\dots,m\}$" src="form_37.png"/> denote the subset of processors that can fulfill job <img class="formulaInl" alt="$j\in\mathcal{J}=\{1,\dots,n\}$" src="form_38.png"/>.</p>
<p>Each job <em>j</em> is characterized by the following parameters:</p><ul>
<li><img class="formulaInl" alt="$w_j$" src="form_39.png"/>: weight;</li>
<li><img class="formulaInl" alt="$r_j,d_j$" src="form_40.png"/>: release and due dates (the job must be processed during the time interval <img class="formulaInl" alt="$[r_j,d_j]$" src="form_41.png"/>);</li>
<li><img class="formulaInl" alt="$p_{ji}$" src="form_42.png"/>: processing time on processor <img class="formulaInl" alt="$i\in \mathcal{M}_j$" src="form_43.png"/>.</li>
</ul>
<p><em>Precedence relations</em> between jobs are given by an acyclic digraph <img class="formulaInl" alt="$G=(\mathcal{J},E)$" src="form_44.png"/> defined on the set of jobs: for any arc <img class="formulaInl" alt="$(j_1,j_2)\in \mathcal{J}$" src="form_45.png"/>, job <img class="formulaInl" alt="$j_2$" src="form_46.png"/> cannot start until job <img class="formulaInl" alt="$j_1$" src="form_47.png"/> is finished.</p>
<p>In general not all jobs can be processed. Our goal is to maximize the weighted sum of processed jobs.</p>
<h2><a class="anchor" id="sec_JVtime_ind"></a>
Time-Index Formulation</h2>
<p>A time-index formulation is based on time-discretization, i.e., the planning horizon &mdash; from time <img class="formulaInl" alt="$R_{\min}=\min_{1\le j\le n}{r_j}$" src="form_48.png"/> to time <img class="formulaInl" alt="$D_{\max}=\max_{1\le j\le n}{d_j}$" src="form_49.png"/> &mdash; is divided into periods, and period $t$ starts at time <em>t</em> and ends at time <em>t</em>+1. We repsesent a <em>schedule</em> by a family of <em>decision</em> binary variables <img class="formulaInl" alt="$\{x_{jit}\}$" src="form_50.png"/>, where <img class="formulaInl" alt="$x_{jit}$" src="form_51.png"/> takes value 1 if job&#160;<em>j</em> starts in period&#160;<em>t</em> on processor&#160;<em>i</em>; otherwise, <img class="formulaInl" alt="$x_{jit}=0$" src="form_52.png"/>. To formulate precedence relations we need three families of <em>auxiliary</em> variables, which are uniquely defined by the decision variables <img class="formulaInl" alt="$x_{jit}$" src="form_51.png"/>:</p><ul>
<li><img class="formulaInl" alt="$y_j=1$" src="form_53.png"/> if job&#160;<em>j</em> is processed; otherwise, <img class="formulaInl" alt="$y_j=0$" src="form_54.png"/>;</li>
<li><img class="formulaInl" alt="$s_j$" src="form_55.png"/>: start time of job&#160;<em>j</em>;</li>
<li><img class="formulaInl" alt="$p^t_j$" src="form_56.png"/>: processing time (duration) of job&#160;<em>j</em>.</li>
</ul>
<p>We consider the following time-index formulation M.E.&#160;Dyer, L.A.&#160;Wolsey. Formulating the single-machine sequencing problem with release dates as a mixed integer program. <em>Discrete Appl. Math.</em> (1990) <b>26</b> 255&ndash;270.):</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align} &amp;\sum_{j=1}^n w_j y_j \to \max, \tag{1.a}\\ &amp;\sum_{\stackrel{1\le j\le n:}{r_j\le t\le d_j-p_{ji}}} \sum_{\tau=\max\{t-p_{ji},r_j\}}^{\min\{t,d_j-p_{ji}\}} x_{ji\tau} \le 1,\quad t=R_{\min},\dots,D_{\max};\; i=1,\dots,m, \tag{1.b}\\ &amp;y_j = \sum_{i\in\mathcal{M}_j} \sum_{t=r_j}^{d_j-p_{ji}} x_{jit},\quad j=1,\dots,n,\tag{1.c}\\ &amp;s_j = \sum_{i\in\mathcal{M}_j} \sum_{t=r_j}^{d_j-p_{ji}} t\cdot x_{jit},\quad j=1,\dots,n,\tag{1.d}\\ &amp;p^t_j = \sum_{i\in\mathcal{M}_j} \sum_{t=r_j}^{d_j-p_{ji}} p_{ji}\cdot x_{jit},\quad j=1,\dots,n,\tag{1.e}\\ &amp;y_{j_1} - y_{j_2} \ge 0,\quad (j_1,j_2)\in E,\tag{1.f}\\ &amp;s_{j_2} - s_{j_1} \ge p^t_{j_1},\quad (j_1,j_2)\in E, \tag{1.g}\\ &amp;x_{jit} \in\{0,1\},\quad i\in\mathcal{M}_j;\;t=r_j,\dots,d_j-p_{ji};\; j=1,\dots,n, \tag{1.h}\\ &amp;y_j \in \{0,1\},\quad j=1,\dots,n. \tag{1.i} \end{align}" src="form_57.png"/>
</p>
<p>The objective (1.a) is to maximize the weighted number of processed jobs.</p>
<p>The capacity constraints (1.b) state that any processor fulfills at most one job during any time period.</p>
<p>The equations (1.c), (1.d), and (1.e) determine the values of all auxiliary variables, <img class="formulaInl" alt="$y_j,\; s_j,\text{ and }p^t_j$" src="form_58.png"/>. Simultaneously, the equations (1.c) imply that each job can start only once.</p>
<p>The precedence relations are expressed by the inequalities (1.f) and (1.g). For each pair of related jobs <img class="formulaInl" alt="$(j_1,j_2)\in E$" src="form_59.png"/>, (1.f) requires that <img class="formulaInl" alt="$j_2$" src="form_46.png"/> is not processed if <img class="formulaInl" alt="$j_1$" src="form_47.png"/> is not processed, while (1.g) requires that, if both jobs, <img class="formulaInl" alt="$j_1\text{ and }j_2$" src="form_60.png"/>, are processed, then <img class="formulaInl" alt="$j_1$" src="form_47.png"/> must be finished when <img class="formulaInl" alt="$j_2$" src="form_46.png"/> starts.</p>
<p>An important advantage of the time-index formulation is that it can be easily modified to model many other types of scheduling problems. For examples, if we set <img class="formulaInl" alt="$y_j=1\text{ for all }j$" src="form_61.png"/>, and redefine the objective as follows </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sum_{j=1}^n \sum_{i\in\mathcal{M}_j} \sum_{t=l_j}^{u_j-p_{ji}} (t+p_{ji}) x_{jit} \to \max, \]" src="form_62.png"/>
</p>
<p> we get the problem of scheduling jobs with release and due dates on a number of machines to minimize weighted completion time, denoted as <img class="formulaInl" alt="$m|r_j,d_j|\sum w_jC_j$" src="form_63.png"/>.</p>
<p>In addition, the LP-relaxation of the time-index formulation provides a strong bound: it dominates the bounds provided by other IP formulations. This is because its LP-relaxation is non-preemptive. That is, the relaxation is obtained by slicing jobs into pieces so that each piece is processed without interruption.</p>
<p>The main disadvantage of the time-index formulation is its size: even for one machine problems, there are <em>n + T</em> constraints and there may be up to <em>nT</em> variables. As a result, for instances with many jobs and large processing intervals <img class="formulaInl" alt="$[r_j,d_j]$" src="form_41.png"/>, the LP's will be very big in size, and their solution time will be large.</p>
<h2><a class="anchor" id="sec_classSchedule"></a>
Class Schedule</h2>
<p>In our implementation of model (1) we represent an instance of the scheduling problem by an array of jobs, each job is given as an object of class <code>Job</code>, which is defined as follows.</p>
<div class="fragment"><div class="line"><span class="keyword">package </span>scheduling;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Job {</div><div class="line">        String name;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> release;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getrelease()</div><div class="line">        {<span class="keywordflow">return</span> release;}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> due;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getdue()</div><div class="line">        {<span class="keywordflow">return</span> due;}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> weight;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> getweight()</div><div class="line">        {<span class="keywordflow">return</span> weight;}</div><div class="line"></div><div class="line">        Map&lt;Integer,Integer&gt; machines;</div><div class="line"></div><div class="line">        Map&lt;Integer,Integer&gt; getmachines()</div><div class="line">        {<span class="keywordflow">return</span> machines;}</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span>[] prec;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span>[] getprec() {<span class="keywordflow">return</span> prec;}</div><div class="line">}</div></div><!-- fragment --><p>The members of this class are:</p><ul>
<li><em>name</em>: job name;</li>
<li><em>release</em>: release date;</li>
<li><em>due</em>: due date;</li>
<li><em>weight</em>: job weight;</li>
<li><em>machines</em>: the keys are machines capable of doing this job; the value of <code>machine.get(i)</code> is processing time of this job on machine <code>i</code>;</li>
<li><em>prec</em>: array of preceding jobs.</li>
</ul>
<p>Now we are ready to represent the class, named <code>Schedule</code>, that implements MIP (1).  <div class="fragment"><div class="line"><span class="keyword">package </span>scheduling;</div><div class="line"></div><div class="line"><span class="keyword">import</span> <a class="code" href="namespaceby.html">by</a>.<a class="code" href="namespaceby_1_1bsu.html">bsu</a>.<a class="code" href="namespaceby_1_1bsu_1_1JVmipshell.html">JVmipshell</a>.*;</div><div class="line"><span class="keyword">import</span> java.io.<a class="code" href="classjava_1_1io_1_1IOException.html">IOException</a>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"><span class="keyword">import</span> java.util.Set;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Schedule <span class="keyword">extends</span> MIPshell</div><div class="line">{</div><div class="line">        <span class="keyword">static</span> {</div><div class="line">                System.loadLibrary(<span class="stringliteral">&quot;JVmipcl&quot;</span>);</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">static</span> <span class="keywordtype">int</span> min(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b)</div><div class="line">        {<span class="keywordflow">return</span> (a &lt; b)? a: b;}</div><div class="line"></div><div class="line">        <span class="keyword">static</span> <span class="keywordtype">int</span> max(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b)</div><div class="line">        {<span class="keywordflow">return</span> (a &gt; b)? a: b;}</div></div><!-- fragment --></p>
<p>In the above fragment of code, the crucial part is the static block which loads the library <code>JVmipcl</code> (<code>JVmipcl.so</code> in Linux, or <code>JVmipcl.dll</code> in Windows), which implements the Java Native Interface (<b>JNI</b>) to the <b>MIPCL</b>.</p>
<p>Next, we display the members of <code>Schedule</code>. <div class="fragment"><div class="line"></div><div class="line">        Job[] jobs;</div><div class="line">        </div><div class="line">        <span class="keywordtype">int</span> n;</div><div class="line">        </div><div class="line">        <span class="keywordtype">int</span> m;</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> Rmin;</div><div class="line">        </div><div class="line">        <span class="keywordtype">int</span> Dmax;</div><div class="line">        </div><div class="line">        Map&lt;Integer, Var&gt; x;</div></div><!-- fragment --></p>
<p>Their meanings are the following:</p><ul>
<li><em>jobs</em>: array of jobs to be scheduled;</li>
<li><em>n</em>: number of jobs, <code>n = jobs.length</code>;</li>
<li><em>m</em>: number of machines;</li>
<li><em>Rmin</em>: project start time, i.e., the earliest release date among all jobs;</li>
<li><em>Dmax</em>: project finish time, i.e., the latest due date among all jobs;</li>
<li><em>x</em>: family of binary variables that define the schedule.</li>
</ul>
<p>To simplify posing constraints, we introduced a number of simple functions that "translate" input parameters into parameters of model (1). <div class="fragment"><div class="line">        <span class="keywordtype">int</span> r(<span class="keywordtype">int</span> j) {<span class="keywordflow">return</span> jobs[j].getrelease();}</div><div class="line">        </div><div class="line">        <span class="keywordtype">int</span> d(<span class="keywordtype">int</span> j) {<span class="keywordflow">return</span> jobs[j].getdue();}</div><div class="line">    </div><div class="line">        <span class="keywordtype">int</span> w(<span class="keywordtype">int</span> j) {<span class="keywordflow">return</span> jobs[j].getweight();}</div><div class="line">    </div><div class="line">        <span class="keywordtype">int</span> p(<span class="keywordtype">int</span> j, <span class="keywordtype">int</span> i) {<span class="keywordflow">return</span> jobs[j].getmachines().get(i);}</div><div class="line">                </div><div class="line">        Set&lt;Integer&gt; M(<span class="keywordtype">int</span> j) {<span class="keywordflow">return</span> jobs[j].getmachines().keySet();}</div><div class="line">    </div><div class="line">        <span class="keywordtype">int</span>[] prec(<span class="keywordtype">int</span> j) {<span class="keywordflow">return</span> jobs[j].getprec();}</div></div><!-- fragment --></p>
<p>Two auxiliary functions follow next. <div class="fragment"><div class="line">        <span class="keywordtype">void</span> processData()</div><div class="line">        {</div><div class="line">                <span class="keywordtype">int</span> n = jobs.length;</div><div class="line">                <span class="keywordtype">int</span> m = 0, Rmin = 10000000, Dmax = 0;</div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                        <span class="keywordflow">if</span> (Rmin &gt; r(j))</div><div class="line">                                Rmin = r(j);</div><div class="line">                        <span class="keywordflow">if</span> (Dmax &lt; d(j))</div><div class="line">                                Dmax = d(j);</div><div class="line">                        </div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i : M(j))</div><div class="line">                                <span class="keywordflow">if</span> (m &lt; i)</div><div class="line">                                        m = i;</div><div class="line">                }</div><div class="line"></div><div class="line">                this.n = n;</div><div class="line">                this.m = m+1;</div><div class="line">                this.Rmin = Rmin;</div><div class="line">                this.Dmax = Dmax;</div><div class="line">        }</div><div class="line">    </div><div class="line">        <span class="keywordtype">int</span> ind(<span class="keywordtype">int</span> j, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> t)</div><div class="line">        {<span class="keywordflow">return</span> j + (i + t*m)*n;}</div></div><!-- fragment --></p>
<p>Here, <code>processData()</code> computes the values for four data members: <code>n</code>, <code>m</code>, <code>Rmin</code>, and <code>Dmax</code>. The purpose of <code>ind()</code> is to translate triple indices <code>j,i,t</code> into the flat ones, which are unique integers.</p>
<p>There are two constructors. <div class="fragment"><div class="line">        <span class="keyword">public</span> Schedule(String name)</div><div class="line">        {</div><div class="line">                super(name);</div><div class="line">                jobs = null;</div><div class="line">                x = null;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> Schedule(String name, Job[] jobs)</div><div class="line">        {</div><div class="line">                super(name);</div><div class="line">                model(jobs);</div><div class="line">        } <span class="comment">//</span></div></div><!-- fragment --></p>
<p>In <code>model()</code> we build a <code>MIPshell</code> representation of MIP (1). It starts from defining the <code>MIPshell</code> corresponding to the <img class="formulaInl" alt="$x,\; y,\; s,\text{ and } p^t$" src="form_64.png"/> variables in (1). <div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> model(Job[] jobs)</div><div class="line">        {</div><div class="line">                this.jobs = jobs;</div><div class="line">                processData();</div><div class="line">                </div><div class="line">                VarVector s = <span class="keyword">new</span> VarVector(<span class="keyword">this</span>,<span class="stringliteral">&quot;s&quot;</span>,0,n);</div><div class="line">                VarVector pt = <span class="keyword">new</span> VarVector(<span class="keyword">this</span>,<span class="stringliteral">&quot;pt&quot;</span>,0,n);</div><div class="line">                VarVector y = <span class="keyword">new</span> VarVector(<span class="keyword">this</span>,<span class="stringliteral">&quot;y&quot;</span>,VAR_BIN,n);</div><div class="line">        </div><div class="line">                Map&lt;Integer, Var&gt; x = <span class="keyword">new</span> HashMap&lt;Integer,Var&gt;();</div><div class="line">                this.x = x; <span class="comment">// remember x to display the result later</span></div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i : M(j)) {</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=r(j); t &lt;= d(j)-p(j,i); ++t) {</div><div class="line">                                        x.put(ind(j,i,t), <span class="keyword">new</span> Var(<span class="keyword">this</span>,<span class="stringliteral">&quot;x(&quot;</span>+j+<span class="stringliteral">&quot;,&quot;</span>+i+<span class="stringliteral">&quot;,&quot;</span>+t+<span class="stringliteral">&quot;)&quot;</span>,VAR_BIN));</div><div class="line">                                }</div><div class="line">                        }</div><div class="line">                } <span class="comment">// for (int j=0; j &lt; n; ++j)</span></div></div><!-- fragment --></p>
<p>Three families of variables, <code>s</code>, <code>pt</code> and <code>y</code>, are declared as one dimentional <code>VarVector</code>s. We could declare <code>x</code> as a three dimentional <code>VarVector</code> as well; but many of the variables in that object would be not used. Therefore, we define <code>x</code> to be a map whose keys are flat indices (see above the description of <code>ind()</code>), and whose values are <code>MIPshell</code> variables (of type <code>Var</code>).</p>
<p>Next, we build the objective. <div class="fragment"><div class="line">                LinSum lsum = <span class="keyword">new</span> LinSum();</div><div class="line">                </div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                        lsum.add(w(j),y.get(j));</div><div class="line">                }</div><div class="line">                maximize(lsum);</div></div><!-- fragment --></p>
<p>The following fragment of code builds all conctraints from (1.b). <div class="fragment"><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; m; ++i) {</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=Rmin; t &lt; Dmax; ++t) {</div><div class="line">                                lsum = <span class="keyword">new</span> LinSum();</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                                        <span class="keywordflow">if</span> (M(j).contains(i)) {</div><div class="line">                                                <span class="keywordtype">int</span> t1 = max(t-p(j,i),r(j));</div><div class="line">                                                <span class="keywordtype">int</span> t2 = min(t,d(j)-p(j,i));</div><div class="line">                                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tau=t1; tau &lt;= t2; ++tau)</div><div class="line">                                                        lsum.add(1.0,x.get(ind(j,i,tau)));</div><div class="line">                                        }</div><div class="line">                                }</div><div class="line">                                addCtr(lsum,-VAR_INF,1.0);</div><div class="line">                        }</div><div class="line">                } <span class="comment">// for (int i=0; i &lt; m; ++i)</span></div></div><!-- fragment --></p>
<p>The constraints (1.c), (1.d), (1.e) and the precedence relations (1.f), (1.g) are build in the following loop. <div class="fragment"><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                        lsum = <span class="keyword">new</span> LinSum();</div><div class="line">                        LinSum lsum1 = <span class="keyword">new</span> LinSum();</div><div class="line">                        LinSum lsum2 = <span class="keyword">new</span> LinSum();</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i : M(j)) {</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=r(j); t &lt;= d(j)-p(j,i); ++t) {</div><div class="line">                                        Var x0 = x.get(ind(j,i,t));</div><div class="line">                                        lsum.add(1.0,x0);</div><div class="line">                                        lsum1.add(t,x0);</div><div class="line">                                        lsum2.add(p(j,i),x0);</div><div class="line">                                }</div><div class="line">                        }</div><div class="line">                        addCtr(lsum.add(-1.0,y.get(j)),0.0,0.0);</div><div class="line">                        addCtr(lsum1.add(-1.0,s.get(j)),0.0,0.0);</div><div class="line">                        addCtr(lsum2.add(-1.0,pt.get(j)),0.0,0.0);</div><div class="line">                        </div><div class="line">                        <span class="keywordflow">if</span> (prec(j) != null) {</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j1 : prec(j)) { <span class="comment">// inequalities for precedence relations</span></div><div class="line">                                        lsum = <span class="keyword">new</span> LinSum();</div><div class="line">                                        addCtr(lsum.add(1.0,y.get(j)).add(-1.0,y.get(j1)),-VAR_INF,0.0);</div><div class="line">                                        lsum = <span class="keyword">new</span> LinSum();</div><div class="line">                                        addCtr(lsum.add(1.0,y.get(j)).add(-1.0,y.get(j1))</div><div class="line">                                                        .add(-1.0,pt.get(j1)),0.0,VAR_INF);</div><div class="line">                                }</div><div class="line">                        }</div><div class="line">                } <span class="comment">// for (int j=0; j &lt; n; ++j)</span></div><div class="line"></div><div class="line">        } <span class="comment">// end of model()</span></div></div><!-- fragment --></p>
<p>To print solutions in a more readable form, <code>Schedule</code> overrides the function <code>printSolution()</code> of the base class <code>MIPshell</code>. <div class="fragment"><div class="line">        @Override</div><div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> printSolution()</div><div class="line">        {</div><div class="line">                <span class="keywordflow">if</span> (isSolution()) {</div><div class="line">                        String optSol = (isSolutionOptimal())? <span class="stringliteral">&quot;optimality proven&quot;</span>: <span class="stringliteral">&quot;optimality not proven&quot;</span>;</div><div class="line">                        System.out.printf(<span class="stringliteral">&quot;Cost of scheduled jobs = %.2f - %s%n&quot;</span>,getobjVal(),optSol);</div><div class="line">                        System.out.println(<span class="stringliteral">&quot; ------------------------------------&quot;</span>);</div><div class="line">                        System.out.println(<span class="stringliteral">&quot;|  Job | Processor | Starts |   Ends |&quot;</span>);</div><div class="line">                        System.out.println(<span class="stringliteral">&quot;+------------------------------------+&quot;</span>);</div><div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; n; ++j) {</div><div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i : M(j)) {</div><div class="line">                                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=r(j); t &lt;= d(j)-p(j,i); ++t) {</div><div class="line">                                                <span class="keywordflow">if</span> (x.get(ind(j,i,t)).getval() &gt; 0.5) {</div><div class="line">                                                        System.out.format(<span class="stringliteral">&quot;| %4d | %9d | %6d | %6d |%n&quot;</span>,j,i,t,t+p(j,i));</div><div class="line">                                <span class="keywordflow">break</span>;</div><div class="line">                                                }</div><div class="line">                                        }</div><div class="line">                                }</div><div class="line">                        }</div><div class="line">                        System.out.println(<span class="stringliteral">&quot; ------------------------------------&quot;</span>);</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span> {</div><div class="line">                        <span class="keywordflow">if</span> (isInfeasible())</div><div class="line">                                System.out.println(<span class="stringliteral">&quot;Problem is infeasible&quot;</span>);</div><div class="line">                        <span class="keywordflow">else</span>                            </div><div class="line">                                System.out.println(<span class="stringliteral">&quot;Time limit reached, no solution has been found&quot;</span>);</div><div class="line">                }</div><div class="line">        }</div><div class="line">} <span class="comment">// end of Schedule</span></div></div><!-- fragment --></p>
<h2><a class="anchor" id="Schedule_using"></a>
Using `Schedule`</h2>
<p>In this section we present an applications that solves scheduling problems written in text files in the <em>json</em> format. To understand the format of input files, it is enough to look at one of them displayed below. </p><div class="fragment"><div class="line">[</div><div class="line">        {</div><div class="line">                &quot;name&quot;: 0,</div><div class="line">                &quot;release&quot;: 0,</div><div class="line">                 &quot;due&quot;: 4,</div><div class="line">                &quot;weight&quot;: 2,</div><div class="line">                &quot;machines&quot;: {0: 2, 1: 3},</div><div class="line">                &quot;prec&quot;: null</div><div class="line">        },</div><div class="line">        {</div><div class="line">                &quot;name&quot;: 1,</div><div class="line">                &quot;release&quot;: 0,</div><div class="line">                 &quot;due&quot;: 6,</div><div class="line">                &quot;weight&quot;: 1,</div><div class="line">                &quot;machines&quot;: {0: 1, 1: 4},</div><div class="line">                &quot;prec&quot;: null</div><div class="line">        },</div><div class="line">        {</div><div class="line">                &quot;name&quot;: 2,</div><div class="line">                &quot;release&quot;: 0,</div><div class="line">                 &quot;due&quot;: 5,</div><div class="line">                &quot;weight&quot;: 3,</div><div class="line">                &quot;machines&quot;: {0: 2, 1: 2},</div><div class="line">                &quot;prec&quot;: null</div><div class="line">        },</div><div class="line">        {</div><div class="line">                &quot;name&quot;: 3,</div><div class="line">                &quot;release&quot;: 3,</div><div class="line">                &quot;due&quot;: 7,</div><div class="line">                &quot;weight&quot;: 1,</div><div class="line">                &quot;machines&quot;: {0: 2, 1: 1},</div><div class="line">                &quot;prec&quot;: null</div><div class="line">        },</div><div class="line">        {</div><div class="line">        &quot;name&quot;: 4,</div><div class="line">                &quot;release&quot;: 2,</div><div class="line">                &quot;due&quot;: 8,</div><div class="line">                &quot;weight&quot;: 3,</div><div class="line">                &quot;machines&quot;: {0: 4, 1: 3},</div><div class="line">                &quot;prec&quot;: null</div><div class="line">        },</div><div class="line">        {</div><div class="line">                &quot;name&quot;: 5,</div><div class="line">                &quot;release&quot;: 6,</div><div class="line">                &quot;due&quot;: 12,</div><div class="line">                &quot;weight&quot;: 2,</div><div class="line">                &quot;machines&quot;: {0: 3, 1: 4},</div><div class="line">                &quot;prec&quot;: null</div><div class="line">        },</div><div class="line">        {</div><div class="line">                &quot;name&quot;: 6,</div><div class="line">                &quot;release&quot;: 1,</div><div class="line">                &quot;due&quot;: 10,</div><div class="line">                &quot;weight&quot;: 4,</div><div class="line">                &quot;machines&quot;: {0: 5, 1: 4},</div><div class="line">                &quot;prec&quot;: null</div><div class="line">        },</div><div class="line">        {</div><div class="line">                &quot;name&quot;: 7,</div><div class="line">                &quot;release&quot;: 2,</div><div class="line">                &quot;due&quot;: 8,</div><div class="line">                &quot;weight&quot;: 2,</div><div class="line">                &quot;machines&quot;: {0: 4, 1: 2},</div><div class="line">                &quot;prec&quot;: null</div><div class="line">        },</div><div class="line">        {</div><div class="line">                &quot;name&quot;: 8,</div><div class="line">                &quot;release&quot;: 0,</div><div class="line">                &quot;due&quot;: 9,</div><div class="line">                &quot;weight&quot;: 1,</div><div class="line">                &quot;machines&quot;: {0: 1, 1: 3},</div><div class="line">                &quot;prec&quot;: null</div><div class="line">        },</div><div class="line">        {</div><div class="line">                &quot;name&quot;: 9,</div><div class="line">                &quot;release&quot;: 5,</div><div class="line">                &quot;due&quot;: 12,</div><div class="line">                &quot;weight&quot;: 3,</div><div class="line">                &quot;machines&quot;: {0: 5, 1: 5},</div><div class="line">                &quot;prec&quot;: null</div><div class="line">        }</div><div class="line">]</div></div><!-- fragment --><p>The main class of our application, called <code>testSchedule</code>, is implemented as follows. </p><div class="fragment"><div class="line"><span class="keyword">package </span>scheduling;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.Reader;</div><div class="line"><span class="keyword">import</span> java.io.FileReader;</div><div class="line"><span class="keyword">import</span> com.google.gson.Gson;</div><div class="line"><span class="keyword">import</span> com.google.gson.GsonBuilder;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>testSchedule {</div><div class="line">        <span class="keyword">static</span> {</div><div class="line">                System.loadLibrary(<span class="stringliteral">&quot;JVmipcl&quot;</span>);</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> main(String[] args) {</div><div class="line">                <span class="keywordflow">try</span> {</div><div class="line">                        Job[] jobs = readJobs(args[0]);</div><div class="line">                        Schedule sh = <span class="keyword">new</span> Schedule(<span class="stringliteral">&quot;test&quot;</span>);</div><div class="line">                        sh.model(jobs);</div><div class="line">                        sh.optimize();</div><div class="line">                        sh.printSolution();             </div><div class="line">                } <span class="keywordflow">catch</span>(Throwable e) {</div><div class="line">                        e.printStackTrace();</div><div class="line">                }</div><div class="line">        }</div><div class="line">        </div><div class="line">        <span class="keyword">static</span> Job[] readJobs(String fileName) <span class="keywordflow">throws</span> IOException {</div><div class="line">                <span class="keywordflow">try</span>(Reader reader = <span class="keyword">new</span> FileReader(fileName)){</div><div class="line">                        Gson gson = <span class="keyword">new</span> GsonBuilder().create();</div><div class="line">                        Job[] jobs = gson.fromJson(reader, Job[].<span class="keyword">class</span>);</div><div class="line">                        <span class="keywordflow">return</span> jobs;</div><div class="line">                }</div><div class="line">        }</div><div class="line"></div><div class="line">}</div></div><!-- fragment --><p>In its static block, <code>testSchedule</code>, loads the <code>JVmipcl</code> library (<code>mipcl.so</code> in Linux, or <code>mipcl.dll</code> in Windows). The <code>main()</code> function first reads an instance of the scheduling problem into an array of <code>Job</code> objects. This is done by calling <code>readJobs()</code>, which implementation is surprisingly simple and short. Then, <code>main()</code> creates and object of the <code>Schedule</code> class. After that, it calls <code>model()</code> to builds the <code>MIPshell</code> model, which is then optimized with the call to <code>optimize()</code>. An optimal schedule is printed by the call to <code>printSolution()</code>.</p>
<p>In Linux, to compile this test application, do the following: </p><pre class="fragment"> cd $MIPCLDIR/mipcl-java/examples/scheduling
 ./compile
</pre><p>If we run our test program </p><pre class="fragment"> ./run tests/test1.json
</pre><p>with input parameter set to <code>tests/test1.json</code>, we get the following schedule: </p><pre class="fragment">Cost of scheduled jobs = 17.00 - optimality proven
 ------------------------------------
|  Job | Processor | Starts |   Ends |
+------------------------------------+
|    0 |         0 |      0 |      2 |
|    2 |         1 |      0 |      2 |
|    4 |         1 |      3 |      6 |
|    5 |         0 |      9 |     12 |
|    6 |         0 |      3 |      8 |
|    9 |         1 |      7 |     12 |
 ------------------------------------</pre><p><b>Remark</b>: On Windows computers, to compile applications and then run tests, we execute two batch files <code>compile.bat</code> and <code>run.but</code>.</p>
<p>Alternatively, if you prefer using <b>ant</b>, both, in Linux and Windows, to compile and then run our test program, type the following commands: </p><pre class="fragment">ant jar
ant run -Dfilename=tests/test1.json</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 12 2017 00:28:59 for JVmipcl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
